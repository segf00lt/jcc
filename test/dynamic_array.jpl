proc main() {
    arr: [..]int;
    buf: [12]int;
    arr.data = buf.data;
    arr.cap  = sizeof(buf);
    arr[0] = 12;
    array_int_push(@arr, 13);
    array_int_push(@arr, 15);
    array_int_push(@arr, 32);

    //TODO something wrong with sign extension
    // for some reason if you implicit cast and int to something else
    // it breaks the printing
    i: int = 0;
    print("arr = [");
    while i < arr.count - 1 {
        defer i++;
        print("%, ", arr[i]);
    }
    print("%]\n", arr[arr.count-1]);

    arr2: [..]int;
    arr3: [..]int;
    arr2 = arr3;

    arr4 := array_int_make(53);
    print("arr4.cap = %\n", arr4.cap);

    arr4 = array_int_make(12);
    print("arr4.cap = %\n", arr4.cap);

}

proc array_int_make(cap: u64) [..]int {
    arr: [..]int;
    arr.cap = cap;
    return arr;
}

proc array_int_push(arr: *[..]int, x: int) {
    arr[][arr.count] = x;
    arr.count++;
}

#run main();
